spring.application.name=api-gateway
server.port=8080

# ============================================
# Eureka Service Discovery Configuration
# ============================================
eureka.client.service-url.defaultZone=http://localhost:8761/eureka/
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true
eureka.instance.prefer-ip-address=true
eureka.instance.instance-id=${spring.application.name}:${spring.application.instance-id:${random.value}}

# ============================================
# Spring Cloud Config Client Configuration
# ============================================
spring.config.import=optional:configserver:${CONFIG_SERVER:http://localhost:8888}
spring.cloud.config.enabled=true
spring.cloud.config.fail-fast=false

# ============================================
# Spring Cloud Gateway Configuration
# ============================================

# Organizations Service Routes
spring.cloud.gateway.routes[0].id=organizations-service
spring.cloud.gateway.routes[0].uri=lb://organizations-service
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/organizations/**
spring.cloud.gateway.routes[0].filters[0]=RewritePath=/api/organizations/(?<path>.*), /organizations/$\{path}

# OrgDirectories Service Routes
spring.cloud.gateway.routes[1].id=orgdirectories-service
spring.cloud.gateway.routes[1].uri=lb://orgdirectories-service
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/orgdirectory/**

# CORS Configuration
spring.cloud.gateway.globalcors.cors-configurations[/**].allowed-origins=*
spring.cloud.gateway.globalcors.cors-configurations[/**].allowed-methods=GET,POST,PUT,DELETE,OPTIONS,PATCH
spring.cloud.gateway.globalcors.cors-configurations[/**].allowed-headers=*
spring.cloud.gateway.globalcors.cors-configurations[/**].allow-credentials=true

# Gateway Timeouts
spring.cloud.gateway.httpclient.connect-timeout=5000
spring.cloud.gateway.httpclient.response-timeout=30000

# Actuator Configuration
management.endpoints.web.exposure.include=health,info,metrics,gateway
management.endpoint.health.show-details=always
management.endpoint.gateway.enabled=true

# Logging
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.ru.itmo.soa=DEBUG

